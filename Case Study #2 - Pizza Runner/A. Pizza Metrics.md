# üçïCase Study #2: Pizza Runner

### 1. How many pizza were ordered? 
```sql
SELECT COUNT(*) AS NUM_PIZZA_ORDERS
FROM PIZZA_RUNNER.CUSTOMER_ORDERS
```
### 2. How many unique customer orders were made?
```sql
SELECT COUNT(DISTINCT ORDER_ID) AS UNIQUE_CUST_ORDER
FROM PIZZA_RUNNER.CUSTOMER_ORDERS
``` 
### 3. How many successful orders were delivered by each runner?
```sql
SELECT 
 RUNNER_ID,
 COUNT(ORDER_ID) AS SUCCESSFUL_ORDERS
FROM PIZZA_RUNNER.RUNNER_ORDERS
WHERE CANCELLATION IS NULL
GROUP BY RUNNER_ID
```
### 4. How many of each type of pizza was delivered?
-- 9 MEATLOVERS, 3 VEGGIE

```sql
SELECT 
 P.PIZZA_NAME, 
 COUNT(*) AS NUM_PIZZAS_ORDERED
FROM PIZZA_RUNNER.CUSTOMER_ORDERS C
INNER JOIN PIZZA_RUNNER.PIZZA_NAMES P ON C.PIZZA_ID = P.PIZZA_ID
INNER JOIN PIZZA_RUNNER.RUNNER_ORDERS R ON R.ORDER_ID = C.ORDER_ID
WHERE R.CANCELLATION IS NULL
GROUP BY PIZZA_NAME
```

### 5. How many Vegetarian and Meatlovers were ordered by each customer?

```sql
SELECT
 C.CUSTOMER_ID, 
 P.PIZZA_NAME,
	COUNT(*) AS NUM_PIZZA_ORDERED
FROM PIZZA_RUNNER.CUSTOMER_ORDERS C
LEFT JOIN PIZZA_RUNNER.PIZZA_NAMES P ON P.PIZZA_ID = C.PIZZA_ID
GROUP BY CUSTOMER_ID, PIZZA_NAME
ORDER BY 1
```

### 6. What was the maximum number of pizzas delivered in a single order
-- Could also be solved using a CTE and calling the MAX function

```sql
SELECT
 C.ORDER_ID,
 COUNT(*) AS PIZZA_ORDERED
FROM PIZZA_RUNNER.CUSTOMER_ORDERS C
LEFT JOIN PIZZA_RUNNER.RUNNER_ORDERS R ON R.ORDER_ID = C.ORDER_ID
WHERE CANCELLATION IS NULL
GROUP BY C.ORDER_ID
ORDER BY 2 DESC
LIMIT 1
```

### 7. For each customer, how many delivered pizzas had at least 1 change and how many had no changes?

```sql
SELECT
 C.CUSTOMER_ID, 
 COUNT(
  CASE WHEN C.EXCLUSIONS IS NOT NULL OR C.EXTRAS IS NOT NULL THEN 1 END) AS PIZZA_WITH_CHANGES,

 COUNT(
  CASE WHEN C.EXCLUSIONS IS NULL AND C.EXTRAS IS NULL THEN 1 END) AS PIZZA_WITHOUT_CHANGES
FROM PIZZA_RUNNER.CUSTOMER_ORDERS C
LEFT JOIN PIZZA_RUNNER.RUNNER_ORDERS R ON R.ORDER_ID = C.ORDER_ID
WHERE CANCELLATION IS NULL
GROUP BY C.CUSTOMER_ID
ORDER BY 1
```

### 8. How many pizzas were delivered that had both exclusions and extras?

```sql
SELECT 
 COUNT(*)
FROM PIZZA_RUNNER.CUSTOMER_ORDERS C
LEFT JOIN PIZZA_RUNNER.RUNNER_ORDERS R ON R.ORDER_ID = C.ORDER_ID
WHERE EXCLUSIONS IS NOT NULL AND EXTRAS IS NOT NULL
AND CANCELLATION IS NOT NULL
```

### 9. What was the total volume of pizzas ordered for each hour of the day?

```sql
SELECT
 EXTRACT('HOUR' FROM ORDER_TIME) AS HOUR_OF_DAY, 
 COUNT(*) AS NUM_PIZZAS
FROM PIZZA_RUNNER.CUSTOMER_ORDERS C
GROUP BY HOUR_OF_DAY
ORDER BY 1
``` 
### 10. What was the volume of orders for each day of the week?

```sql
SELECT
 TO_CHAR(ORDER_TIME, 'Day') AS DAY_OF_WK,
 COUNT(*) AS NUM_PIZZAS
FROM PIZZA_RUNNER.CUSTOMER_ORDERS C
GROUP BY DAY_OF_WK
ORDER BY 2
```
