
### 1. How many runners signed up for each 1 week period? (i.e. week starts 2021-01-01)
-- Also could use 'EXTRACT' or 'DATE_PART', however the weeks displayed incorrectly, hence the solution below

```sql
SELECT
 CASE
   WHEN REGISTRATION_DATE BETWEEN '2021-01-01' AND '2021-01-07' THEN 'Week 1'
   WHEN REGISTRATION_DATE BETWEEN '2021-01-08' AND '2021-01-14' THEN 'Week 2'
   WHEN REGISTRATION_DATE BETWEEN '2021-01-15' AND '2021-01-21' THEN 'Week 3'
   END AS REGISTRATION_WEEK,
 COUNT(*) AS NUM_RUNNERS_REGISTER
FROM PIZZA_RUNNER.RUNNERS
GROUP BY REGISTRATION_WEEK
```

### 2. What was the average time in minutes it took for each runner to arrive at the Pizza Runner HQ to pickup the order?
```sql
WITH MINUTES_TO_PICKUP AS (
SELECT
 RUNNER_ID,
 DATE_PART('MINUTE', R.PICKUP_TIME - C.ORDER_TIME) AS MINUTES
FROM PIZZA_RUNNER.CUSTOMER_ORDERS C
INNER JOIN PIZZA_RUNNER.RUNNER_ORDERS R ON R.ORDER_ID = C.ORDER_ID
GROUP BY RUNNER_ID, C.ORDER_TIME, R.PICKUP_TIME
ORDER BY 1
)
	
SELECT
 RUNNER_ID,
 AVG(MINUTES) AS AVG_ARRIVAL_TIME
FROM MINUTES_TO_PICKUP
GROUP BY RUNNER_ID
```

### 3. Is there any relationship between the number of pizzas and how long the order takes to prepare?

```sql
WITH PREP_TIME AS (
SELECT
 COUNT(C.ORDER_ID) AS NUM_PIZZAS,
 DATE_PART('MINUTE', R.PICKUP_TIME - C.ORDER_TIME) AS MINUTES
FROM PIZZA_RUNNER.CUSTOMER_ORDERS C
INNER JOIN PIZZA_RUNNER.RUNNER_ORDERS R ON R.ORDER_ID = C.ORDER_ID
WHERE PICKUP_TIME IS NOT NULL
GROUP BY C.ORDER_ID, C.ORDER_TIME, R.PICKUP_TIME
ORDER BY 1
)
--SELECT * FROM PREP_TIME

SELECT
 NUM_PIZZAS,
 AVG(MINUTES) AS PREP_MINUTES,
 (AVG(MINUTES) / NUM_PIZZAS) AS PREP_PER_PIZZA
FROM PREP_TIME
GROUP BY 1
```
### 4. What was the average distance travelled for each customer?

```sql
SELECT
 CUSTOMER_ID,
 AVG(DISTANCE) AS AVG_DISTANCE
FROM PIZZA_RUNNER.CUSTOMER_ORDERS C
INNER JOIN PIZZA_RUNNER.RUNNER_ORDERS R ON R.ORDER_ID = C.ORDER_ID
WHERE DURATION IS NOT NULL
GROUP BY C.CUSTOMER_ID
ORDER BY 1
```
### 5. What was the difference between the longest and shortest delivery times for all orders?

```sql
SELECT
 (MAX(DURATION) - MIN(DURATION)) AS DELIVERY_TIME_DIFF
FROM PIZZA_RUNNER.RUNNER_ORDERS
WHERE DURATION IS NOT NULL
```

### 6. What was the average speed for each runner for each delivery and do you notice any trend for these values?

```sql
SELECT
 RUNNER_ID,
 C.ORDER_ID,
 COUNT( C.ORDER_ID) AS NUM_PIZZAS, 
 R.DISTANCE,
 R.DURATION,
 (R.DISTANCE / R.DURATION * 60) AS AVG_SPEED
FROM PIZZA_RUNNER.CUSTOMER_ORDERS C 
INNER JOIN PIZZA_RUNNER.RUNNER_ORDERS R ON R.ORDER_ID = C.ORDER_ID
WHERE CANCELLATION IS NULL
GROUP BY RUNNER_ID, C.ORDER_ID, DISTANCE, DURATION
ORDER BY 1
```

### 7. What is the successful delivery percentage for each runner?
```sql
SELECT
 RUNNER_ID,
 COUNT(CASE WHEN CANCELLATION IS NULL THEN 1 END) * 100 / COUNT(*) AS SUCCESSFUL_DELIVERY_RATE
FROM PIZZA_RUNNER.RUNNER_ORDERS
GROUP BY RUNNER_ID
```
